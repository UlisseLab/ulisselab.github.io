#!/usr/bin/python3
import binascii

knapsacks = [
[[22960, 57400, 172200, 80293, 217986, 160385, 366690, 101846, 272572, 212157, 91327, 274494, 193041, 30135, 152110, 361620], 794603],
[[24250, 121250, 291000, 166507, 454264, 420285, 376577, 313411, 150704, 362033, 235823, 483771, 455049, 385480, 331217, 222691], 1381769],
[[28784, 158312, 345408, 333545, 180291, 461326, 435853, 442475, 26488, 168112, 379400, 329569, 273083, 59367, 262654, 96077], 1922704],
[[19414, 67949, 223261, 18698, 134466, 327174, 197403, 443341, 410323, 373408, 289871, 132504, 332957, 247797, 67770, 145247], 2407303],
[[13954, 34885, 83724, 216287, 163902, 94017, 215942, 149258, 36821, 94573, 251939, 270091, 23769, 89400, 185777, 95905], 802777],
[[28322, 141610, 368186, 325781, 198488, 411137, 355039, 242843, 89256, 249317, 88043, 218569, 465460, 67255, 276120, 127488], 1910664],
[[28376, 184444, 468204, 387473, 211823, 522962, 454425, 388291, 185083, 426918, 333277, 145995, 433870, 332993, 159615, 361794], 1590193],
[[21692, 86768, 216920, 65245, 217258, 55075, 218610, 3549, 104712, 263654, 137021, 382502, 374717, 369993, 382237, 417571], 1721406],
[[13468, 47138, 101010, 222222, 161475, 33247, 113632, 287870, 50206, 134082, 12131, 78134, 223608, 218119, 207141, 171717], 860667],
[[11306, 33918, 84795, 203508, 95370, 230311, 137670, 331870, 877, 35672, 99609, 204871, 86790, 224457, 142921, 342372], 1135402],
[[24006, 120030, 360090, 202400, 416803, 375841, 293917, 154075, 428180, 398595, 279410, 53043, 118089, 272187, 62603, 197224], 1742325],
[[28182, 140910, 394548, 329726, 185991, 428346, 355049, 194364, 501456, 529451, 69707, 181687, 391556, 323742, 103568, 249409], 2290978],
[[19734, 69069, 197340, 11441, 121552, 322040, 241107, 59507, 207817, 455102, 35189, 119713, 328229, 243618, 74396, 198127], 635079],
[[27976, 139880, 335712, 276373, 157695, 343366, 249717, 118371, 278706, 78433, 170854, 467600, 89146, 304184, 143377, 370682], 2184707],
[[20638, 72233, 185742, 50131, 131219, 324352, 337670, 11996, 85906, 182131, 42909, 106456, 295464, 331489, 30591, 154053], 1006541],
[[13108, 39324, 104864, 275268, 191297, 56125, 125358, 283486, 201179, 56227, 132116, 303556, 234765, 129953, 266460, 206451], 1353047],
[[33118, 198708, 563006, 556645, 610159, 601274, 30696, 127628, 371169, 156412, 412178, 254989, 609332, 632738, 159860, 369397], 3334335],
[[32140, 224980, 546380, 519503, 465749, 406451, 287855, 114943, 374516, 223985, 560460, 6546, 173792, 508284, 539731, 29368], 1360193],
[[27406, 137030, 356278, 292945, 111467, 264043, 94772, 312871, 206131, 480777, 26411, 80228, 242674, 24628, 90365, 235542], 1189373],
[[13138, 39414, 124811, 256191, 181775, 46081, 125007, 276290, 195697, 87063, 213540, 83335, 212653, 88130, 189398, 21913], 1177316],
[[12870, 32175, 109395, 250965, 169339, 6087, 57219, 159483, 18550, 75710, 164290, 8859, 56328, 170571, 14986, 55712], 858818],
[[21564, 107820, 247986, 108917, 250180, 70177, 183482, 410092, 2946, 81366, 173514, 379374, 360911, 377895, 357953, 307287], 821719],
[[32250, 193500, 483750, 465323, 412344, 419261, 368595, 186638, 502276, 486250, 454198, 454594, 487636, 440845, 379513, 240724], 3266844],
[[14814, 44442, 103698, 274059, 238220, 188763, 45407, 127849, 270512, 245940, 219017, 142950, 330342, 3853, 22520, 111703], 1364000],
[[21038, 115709, 252456, 84104, 220803, 31317, 94191, 219939, 481954, 6583, 118356, 310345, 220920, 462878, 10507, 31533], 640355],
[[12960, 38880, 103680, 226800, 159191, 30453, 86826, 186612, 72335, 177070, 46771, 145382, 9315, 25110, 69660, 197640], 636293],
[[21498, 85992, 268725, 97192, 291125, 88247, 187243, 471227, 480698, 510389, 494528, 473555, 442358, 379964, 319670, 134588], 2384639],
[[15960, 47880, 143640, 327180, 299779, 300837, 255073, 163545, 12409, 56738, 185296, 87831, 255462, 204223, 93765, 203490], 1310946],
[[10644, 31932, 69186, 154338, 53917, 134444, 24773, 70834, 178922, 140339, 25919, 73126, 156896, 80321, 176608, 146355], 1024287],
[[27658, 165948, 401041, 306342, 130773, 399836, 234787, 538719, 554040, 5968, 25765, 65359, 227521, 482700, 428173, 291461], 1327041],
[[18844, 131908, 292082, 65155, 149154, 307730, 49341, 183480, 404648, 318553, 70987, 217350, 500654, 482299, 445589, 381591], 2069544],
[[13392, 33480, 80352, 167400, 124649, 12363, 91686, 230244, 6706, 53588, 140656, 51073, 108842, 34317, 82026, 204228], 1103756],
[[23150, 104175, 277800, 131493, 332436, 240765, 57423, 195871, 37085, 108895, 321965, 266123, 166014, 521, 82067, 245159], 1268251],
[[12076, 30190, 78494, 187178, 121187, 248412, 243655, 228103, 160771, 38183, 88442, 188960, 112675, 243464, 215645, 147931], 1070747],
[[26188, 170222, 366632, 224429, 5493, 141926, 323134, 242185, 27911, 82010, 229490, 67991, 175264, 442186, 493383, 73848], 1966885]]

msg = ''
for knap in knapsacks:
	knapsack = knap[0]
	sum = knap[1]

	# For each knapsack we bruteforce all the 16 bit possible combination = 2^16 = 65536
	for n in range(65536):
		sum_values = 0
		i=0

		# Convert the number to binary format
		numbin = "{0:b}".format(n).zfill(16)
		for let in numbin:
			# For each bit 1 in the binary number, we add to the sum the number in the knapsack with the corresponding index in the array
			if let == '1':
				sum_values += knapsack[i]
			i+=1
		# If the calculated sum corresponds to the one in the knapsack then we found the original plaintext
		if(sum_values == sum):
			numint = int('0b'+numbin, 2)
			msg += binascii.unhexlify('%x' % numint).decode()
print(msg)

# After running the script we recover the following plaintext:
# The honor is all mine.Get yourself a copper key. kn4ps4ck_brut3_f0rrc3
